@page "/home"

@using Project.Models;
@inject Models.UserState UserState
@inject NavigationManager NavigationManager


@if (UserState.isSet())
{
    <h1>Welcome @UserState.getPatient().patientInfo.Name!</h1>
    <h3>Check your meds for today</h3>

    @foreach (var medication in medList)
    {
        <input class="form-check-input" type="checkbox" @bind="medication.Selected" /> @medication.Name <br />
    }

    @* <button @onclick="ShowSelectedValues">Show Selected Values</button> *@
    @* <p>Output: @OutPutValue</p> *@
}
else
{
    <h1>Welcome! Choose profile :)</h1>

}

Navigate to <button @onclick="NavigateToPatients">Patients</button> to choose or change your profile!


@code {
    public List<Medication> medList { get; set; } = new List<Medication>();
    protected List<string> SelectedIds = new List<string>();
    public string OutPutValue { get; set; }


    protected override void OnInitialized()
    {
        UpdateMedList();
    }

    private void UpdateMedList()
    {
        var patient = UserState.getPatient();
        if (patient != null)
        {
            medList = patient.medList;
        }
    }

    protected void ShowSelectedValues()
    {
        OutPutValue = string.Join(",", medList.Where(m => m.Selected).Select(m => m.Name).ToArray());
        StateHasChanged();
    }

    private void NavigateToPatients()
    {
        NavigationManager.NavigateTo("/Patients");
    }
}